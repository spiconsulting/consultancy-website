{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <article>
        {% if post.image_file %}
            <div class="mb-4">
                {% if post.image_file.startswith('http') %}
                    <img src="{{ post.image_file }}" class="img-fluid rounded blog-post-image" alt="{{ post.title }}">
                {% else %}
                    <img src="{{ url_for('static', filename='post_images/' + post.image_file) }}" class="img-fluid rounded blog-post-image" alt="{{ post.title }}">
                {% endif %}
            </div>
        {% endif %}
        <div class="border-bottom pb-3 mb-4">
            <h1 class="display-5">{{ post.title }}</h1>
            <div class="d-flex justify-content-between align-items-center">
                <p class="text-muted mb-0">
                    Written by {{ post.author.username }} on {{ post.timestamp.strftime('%B %d, %Y') }}
                </p>
                <!-- UPDATED: Show Edit/Delete buttons ONLY to admins -->
                {% if current_user.is_authenticated and current_user.is_admin %}
                    <div>
                        <a href="{{ url_for('main.update_post', post_id=post.id) }}" class="btn btn-secondary btn-sm me-2">Edit</a>
                        <form action="{{ url_for('main.delete_post', post_id=post.id) }}" method="POST" class="d-inline">
                            <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this post?');">Delete</button>
                        </form>
                    </div>
                {% endif %}
            </div>
        </div>
        <div class="post-content">
            <div class="blog-content-formatted">{{ post.content|safe }}</div>
        </div>
    </article>
</div>
{% endblock %}
